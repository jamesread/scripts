---
- name: "check if OpenShift client is installed"
  stat: path=/usr/bin/oc
  register: oc_command

- name: "Setup repos"
  when: oc_command.stat.islnk is not defined
  block: 
  - shell: subscription-manager repos --disable '*' --enable 'rhel-7-server-rpms' --enable 'rhel-7-server-ose-3.7-rpms' --enable 'rhel-7-server-extras-rpms' --enable 'rhel-7-fast-datapath-rpms'

- yum:
    name: "{{ item }}"
    state: present
  with_items:
    - atomic-openshift-clients
    - docker

